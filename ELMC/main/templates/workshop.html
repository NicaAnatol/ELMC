{% load static %}
<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Workshop ELMC 3D</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><path fill='white' d='M239.1 6.3l-208 78c-18.7 7-31.1 25-31.1 45v225.1c0 18.2 10.3 34.8 26.5 42.9l208 104c13.5 6.8 29.4 6.8 42.9 0l208-104c16.3-8.1 26.5-24.8 26.5-42.9V129.3c0-20-12.4-37.9-31.1-44.9l-208-78C262 2.2 250 2.2 239.1 6.3zM256 68.4l192 72v1.1l-192 78-192-78v-1.1l192-72zm32 356V275.5l160-65v133.9l-160 80z'/></svg>" type="image/svg+xml">
        <link rel="manifest" href="{% static 'pwa/manifest.json' %}">
<meta name="theme-color" content="#667eea">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="ELMC 3D">
<link rel="apple-touch-icon" href="{% static 'pwa/icon-192x192.png' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/workshop.css' %}">
</head>
<body>
{% include 'navbar.html' %}
    <div class="hero-section">
    <div class="hero-content">
        <div class="hero-text">
            <div class="hero-text-context">
                <div class="hero-title-container">
                    <h1>
                        <span class="hero-main-text">Public Workshop</span>
                        <span class="gradient-text">3D Models</span>
                    </h1>
                    <div class="hero-subtitle">
                        <i class="fas fa-users"></i>
                        <h2>Discover 3D models created by the community</h2>
                    </div>
                </div>
                
                <div class="hero-description">
                    <div class="description-content">
                        <div class="description-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="description-text">
                            <p>Access unique 3D models created by an active community of designers. Each model is optimized for easy integration into your personal or professional projects.</p>
                            <div class="description-features">
                                <span class="feature-tag">
                                    <i class="fas fa-star"></i> Premium quality
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-sync-alt"></i> Regular updates
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-comments"></i> Community feedback
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="hero-description">
                    <div class="description-content">
                        <div class="description-icon">
                            <i class="fas fa-compass"></i>
                        </div>
                        <div class="description-text">
                            <p>Explore a vast collection of 3D models generated by users. View in detail, download for your projects, or share your own creations with the community.</p>
                            <div class="description-features">
                                <span class="feature-tag">
                                    <i class="fas fa-eye"></i> 3D Visualization
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-download"></i> Free download
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-share"></i> Community sharing
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="hero-stats">
                <div class="stat-box">
                    <div class="stat-icon">
                        <i class="fas fa-cube"></i>
                    </div>
                    <div class="stat-details">
                        <div class="stat-number" id="totalModels">...</div>
                        <div class="stat-label">Public models</div>
                    </div>
                </div>
                
                <div class="stat-box">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-details">
                        <div class="stat-number" id="totalCreators">...</div>
                        <div class="stat-label">Active creators</div>
                    </div>
                </div>
                
                <div class="stat-box">
                    <div class="stat-icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <div class="stat-details">
                        <div class="stat-number" id="totalDownloads">...</div>
                        <div class="stat-label">Total downloads</div>
                    </div>
                </div>
                
                <div class="stat-box">
                    <div class="stat-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="stat-details">
                        <div class="stat-number" id="totalViews">...</div>
                        <div class="stat-label">Total views</div>
                    </div>
                </div>
            </div>
            
            <div class="hero-actions">
                <div>
                    <button class="hero-btn primary" onclick="showUploadInfo()">
                        <i class="fas fa-upload"></i> How do I publish my model?
                    </button>
                </div>
                <button class="hero-btn secondary" onclick="window.location.href='/home/'; showFeaturedModels();">
                    <i class="fas fa-star"></i> Create your own model
                </button>
            </div>
        </div>
        
        <div class="hero-visual">
            <div class="visual-container">
                <div class="model-preview">
                    <div class="preview-item preview-1">
                        <img src="https://img.cadnav.com/allimg/160322/cadnav-160322221013.jpg" 
                            alt="Urban 3D Model" 
                            class="preview-image"
                            onerror="this.style.display='none'">
                        <div class="preview-badge">
                            <i class="fas fa-building"></i> Urban
                        </div>
                    </div>
                    <div class="preview-item preview-2">
                        <img src="https://static.vecteezy.com/system/resources/thumbnails/051/331/258/small_2x/3d-model-of-a-rocky-terrain-covered-with-lush-green-grass-and-small-plants-ideal-for-nature-and-landscape-projects-png.png" 
                            alt="Natural 3D Model" 
                            class="preview-image"
                            onerror="this.style.display='none'">
                        <div class="preview-badge">
                            <i class="fas fa-tree"></i> Natural
                        </div>
                    </div>
                    <div class="preview-item preview-3">
                        <img src="https://preview.free3d.com/img/2018/02/2273020361568159163/pxr939kt.jpg" 
                            alt="River 3D Model" 
                            class="preview-image"
                            onerror="this.style.display='none'">
                        <div class="preview-badge">
                            <i class="fas fa-water"></i> Water
                        </div>
                    </div>
                </div>
                <div class="floating-element element-1">
                    <i class="fas fa-cube"></i>
                </div>
                <div class="floating-element element-2">
                    <i class="fas fa-map"></i>
                </div>
                <div class="floating-element element-3">
                    <i class="fas fa-layer-group"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="search-border-bg">
    <div class="search-border">
        <div class="search-section">
            <div class="search-container">
                <input type="text" 
                       id="searchInput" 
                       class="search-input" 
                       placeholder="Search models by name, description or author..."
                       onkeypress="handleSearchKeypress(event)">
                <button class="search-btn" onclick="searchModels()">
                    <i class="fas fa-search"></i> Search
                </button>
            </div>
            
            <div class="advanced-filters">
                <div class="filter-group">
                    <label><i class="fas fa-sort-amount-down"></i> Sort by:</label>
                    <select id="sortSelect" class="filter-select" onchange="loadPublicModels()">
                        <option value="newest">Newest</option>
                        <option value="oldest">Oldest</option>
                        <option value="views">Most viewed</option>
                        <option value="elements">Most elements</option>
                        <option value="downloads">Most downloaded</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="fas fa-filter"></i> Element type:</label>
                    <select id="elementTypeSelect" class="filter-select" onchange="loadPublicModels()">
                        <option value="all">All types</option>
                        <option value="buildings">Buildings</option>
                        <option value="highways">Roads</option>
                        <option value="water">Water</option>
                        <option value="natural">Natural</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="fas fa-calendar"></i> Creation date:</label>
                    <select id="dateSelect" class="filter-select" onchange="loadPublicModels()">
                        <option value="all">All time</option>
                        <option value="today">Today</option>
                        <option value="week">This week</option>
                        <option value="month">This month</option>
                        <option value="year">This year</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="message" id="message"></div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Loading models...</p>
        </div>

        <div class="empty-state" id="emptyState" style="display: none;">
            <i class="fas fa-cube"></i>
            <h3>No public models found</h3>
            <p>Try adjusting your search criteria</p>
        </div>

        <div class="models-grid" id="modelsGrid">
        </div>

        <div class="pagination" id="pagination" style="display: none;">
        </div>
    </div>
</div>

<div class="modal" id="modelModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Model Details</h2>
            <button class="close-modal" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div id="modalContent">
            </div>
        </div>
    </div>
</div>

<div class="modal" id="viewerModal" style="display: none;">
    <div class="modal-content" style="max-width: 90%; height: 90vh;">
        <div class="modal-header">
            <h2 id="viewerTitle">3D Viewer</h2>
            <button class="close-modal" onclick="closeViewer()">&times;</button>
        </div>
        <div class="modal-body" style="padding: 0; height: calc(100% - 60px);">
            <div id="viewerContainer" style="width: 100%; height: 100%; position: relative;">
                <canvas id="modelCanvas" style="width: 100%; height: 100%; display: block;"></canvas>
                
                <div style="position: absolute; top: 20px; right: 20px; z-index: 1000;">
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button onclick="resetCamera()" style="background: rgba(30, 41, 59, 0.8); color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-sync-alt"></i> Reset Camera
                        </button>
                        <button onclick="toggleAutoRotate()" id="autoRotateBtn" style="background: rgba(30, 41, 59, 0.8); color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-rotate"></i> Auto Rotate
                        </button>
                        <button onclick="toggleWireframe()" id="wireframeToggleBtn" style="background: rgba(30, 41, 59, 0.8); color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                            <i class="fas fa-code"></i> Wireframe: OFF
                        </button>
                    </div>
                </div>
                
                <div id="viewerLoading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(15, 23, 42, 0.9); padding: 20px 40px; border-radius: 10px; display: none; z-index: 1000;">
                    <div class="spinner" style="width: 40px; height: 40px; margin: 0 auto 15px;"></div>
                    <p style="color: white; text-align: center;">Loading model...</p>
                </div>
                
                <div id="modelInfoPanel" style="position: absolute; bottom: 20px; left: 20px; background: rgba(15, 23, 42, 0.95); padding: 15px; border-radius: 8px; max-width: 350px; min-width: 300px; display: none; z-index: 1000; border: 1px solid #334155; backdrop-filter: blur(10px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);">
                    <button onclick="toggleInfoPanel()" id="toggleInfoBtn" style="position: absolute; top: 10px; right: 10px; background: none; color: #94a3b8; border: none; padding: 5px; border-radius: 4px; cursor: pointer; font-size: 14px; transition: color 0.2s;" title="Hide information">
                        <i class="fas fa-times"></i> 
                    </button>
                    
                    <h4 style="color: #f1f5f9; margin-bottom: 10px; font-size: 16px; border-bottom: 1px solid #334155; padding-bottom: 8px;">Model Information</h4>
                    <div style="color: #cbd5e1; font-size: 14px; line-height: 1.5;">
                        <div><strong>Name:</strong> <span id="infoName">-</span></div>
                        <div><strong>Elements:</strong> <span id="infoElements">0</span></div>
                        <div><strong>Buildings:</strong> <span id="infoBuildings">0</span></div>
                        <div><strong>Size:</strong> <span id="infoSize">0 MB</span></div>
                        <div><strong>Author:</strong> <span id="infoAuthor">-</span></div>
                    </div>
                </div>

                <button onclick="showInfoPanel()" id="showInfoBtn" style="position: absolute; bottom: 20px; left: 20px; background: rgba(102, 126, 234, 0.9); color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; display: none; align-items: center; gap: 8px; z-index: 1000; box-shadow: 0 3px 10px rgba(0,0,0,0.2); transition: all 0.3s;" title="Show model information">
                    show info
                </button>
            </div>
        </div>
    </div>
</div>
<script>
if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js')
            .then(function(registration) {
            })
            .catch(function(err) {
                console.log('ServiceWorker registration failed: ', err);
            });
    });
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
<script src="{% static 'js/workshop.js' %}"></script>
</body>
</html>